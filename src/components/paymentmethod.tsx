import React, { useState } from "react";
import CardForm from "./cardForm";

const PaymentMethod = ({
  data,
  totalPrice,
  totalWithPix,
  formRef,
  changeMethod,
}: any) => {
  const [selectedMethod, setSelectedMethod] = useState("card");
  const [expandedMethod, setExpandedMethod] = useState<string | null>(null);

  const handleSelect = (method: string) => {
    setSelectedMethod(method);
    setExpandedMethod(method);
    changeMethod(method);
  };

  return (
    <div className="payment-methods !rounded-[8px] !border-[0px]">
      <div
        className={`payment-card border-[1px] border-solid !rounded-[8px_8px_0px_0px]  border-b-[#d3d3d3] ${
          selectedMethod === "card" ? "selected" : ""
        }`}
        onClick={() => handleSelect("card")}
      >
        <div className="icon">
          <i>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              focusable="false"
              viewBox="0 0 32 32"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.95571 23.2614C3.4669 23.6881 4.02254 23.7521 4.3337 23.7521C4.35745 23.7521 4.3796 23.7506 4.40018 23.7492H4.40022H4.40025H4.40028H4.40032H4.40035H4.40037C4.45674 23.7453 4.50119 23.7422 4.53373 23.7735H7.71201C8.06763 23.7735 8.33433 23.5174 8.33433 23.176C8.33433 22.8347 8.0454 22.5786 7.71201 22.5786H4.48928H4.40038C4.40038 22.5786 4.04477 22.6 3.75583 22.3652C3.40022 22.0879 3.22242 21.4904 3.22242 20.6583V7.19485H24.648H24.6702C24.6702 7.19485 25.5371 7.17352 26.0705 7.66426C26.3594 7.94164 26.515 8.34704 26.515 8.90179V12.4119C26.515 12.7533 26.7817 13.0093 27.1373 13.0093C27.4929 13.0093 27.7596 12.7319 27.7596 12.4119V8.88045C27.7596 8.00565 27.4707 7.30154 26.915 6.78946C26.0482 6 24.8258 6 24.648 6H2.62232C2.26671 6 2 6.27738 2 6.59743V20.6583C2 21.8532 2.31116 22.728 2.95571 23.2614ZM11.2453 22.5572C10.8897 22.5572 10.623 22.8346 10.623 23.1546C10.623 23.4747 10.8897 23.7307 11.2453 23.7521H16.3572C16.7129 23.7521 16.9796 23.496 16.9796 23.1546C16.9796 22.8132 16.6906 22.5572 16.3572 22.5572H11.2453ZM4.84433 20.5943C4.97768 20.7223 5.13326 20.765 5.31107 20.765C5.46665 20.765 5.62223 20.701 5.73336 20.5943C5.86671 20.4662 5.91116 20.3169 5.91116 20.1462V19.7408C5.91116 19.5914 5.84449 19.4421 5.73336 19.3354C5.6 19.2074 5.46665 19.1647 5.31107 19.1647C5.13326 19.1647 4.97768 19.2287 4.84433 19.3354C4.71098 19.4634 4.66652 19.5914 4.66652 19.7408V20.1462C4.66652 20.3169 4.7332 20.4662 4.84433 20.5943ZM6.82464 20.765C6.64683 20.765 6.49125 20.7223 6.35789 20.5943C6.22454 20.4662 6.15786 20.3169 6.18009 20.1462V19.7408C6.18009 19.5914 6.22454 19.4634 6.35789 19.3354C6.49125 19.2287 6.64683 19.1647 6.82464 19.1647C6.98022 19.1647 7.11357 19.2074 7.24692 19.3354C7.35805 19.4421 7.42473 19.5914 7.42473 19.7408V20.1462C7.42473 20.3169 7.38028 20.4662 7.24692 20.5943C7.1358 20.701 6.98022 20.765 6.82464 20.765ZM8.31228 20.765C8.13447 20.765 7.97889 20.701 7.84554 20.5943C7.71218 20.4662 7.66773 20.3169 7.66773 20.1462V19.7408C7.66773 19.5914 7.73441 19.4421 7.84554 19.3354C7.97889 19.2074 8.11225 19.1647 8.31228 19.1647C8.46786 19.1647 8.62344 19.2287 8.73456 19.3354C8.86792 19.4634 8.91237 19.5914 8.91237 19.7408V20.1462C8.91237 20.3169 8.84569 20.4662 8.73456 20.5943C8.60121 20.701 8.46786 20.765 8.31228 20.765ZM9.75819 20.765C9.58039 20.765 9.42481 20.7223 9.29145 20.5943C9.1581 20.4662 9.11365 20.3169 9.11365 20.1462V19.7408C9.11365 19.5914 9.1581 19.4634 9.29145 19.3354C9.42481 19.2287 9.58039 19.1647 9.75819 19.1647C9.91377 19.1647 10.0471 19.2074 10.1805 19.3354C10.2916 19.4421 10.3583 19.5914 10.3583 19.7408V20.1462C10.3583 20.3169 10.3138 20.4662 10.1805 20.5943C10.0694 20.701 9.91377 20.765 9.75819 20.765ZM12.1797 20.765C12.0019 20.765 11.8463 20.701 11.713 20.5943C11.5796 20.4662 11.5352 20.3169 11.5352 20.1462V19.7408C11.5352 19.5914 11.6019 19.4421 11.713 19.3354C11.8463 19.2074 12.0019 19.1647 12.1797 19.1647C12.3353 19.1647 12.4909 19.2287 12.602 19.3354C12.7354 19.4634 12.7798 19.5914 12.7798 19.7408V20.1462C12.7798 20.3169 12.7131 20.4662 12.602 20.5943C12.4909 20.701 12.3353 20.765 12.1797 20.765ZM13.6913 20.765C13.5135 20.765 13.3579 20.7223 13.2245 20.5943C13.1134 20.4662 13.0467 20.3169 13.0467 20.1462V19.7408C13.0467 19.5914 13.0912 19.4634 13.2245 19.3354C13.3579 19.2287 13.5135 19.1647 13.6913 19.1647C13.8468 19.1647 13.9802 19.2074 14.1135 19.3354C14.2247 19.4421 14.2914 19.5914 14.2914 19.7408V20.1462C14.2914 20.3169 14.2469 20.4662 14.1135 20.5943C14.0024 20.701 13.8468 20.765 13.6913 20.765ZM15.1787 20.765C15.0009 20.765 14.8454 20.701 14.712 20.5943C14.5786 20.4662 14.5342 20.3169 14.5342 20.1462V19.7408C14.5342 19.5914 14.6009 19.4421 14.712 19.3354C14.8454 19.2074 14.9787 19.1647 15.1787 19.1647C15.3343 19.1647 15.4899 19.2287 15.601 19.3354C15.7344 19.4634 15.7788 19.5914 15.7788 19.7408V20.1462C15.7788 20.3169 15.7122 20.4662 15.601 20.5943C15.4899 20.701 15.3565 20.765 15.1787 20.765ZM16.6469 20.765C16.4691 20.765 16.3135 20.7224 16.1801 20.5943C16.0468 20.4663 15.9801 20.317 15.9801 20.1249V19.7195C15.9801 19.5702 16.0246 19.4422 16.1579 19.3141C16.2913 19.2075 16.4468 19.1434 16.6247 19.1434C16.8025 19.1434 16.9358 19.2075 17.0692 19.3355C17.1803 19.4422 17.247 19.5915 17.247 19.7409V20.1463C17.247 20.317 17.2025 20.4663 17.0692 20.5943C16.958 20.701 16.8025 20.765 16.6469 20.765Z"
                fill="currentColor"
              ></path>
              <path
                d="M26.5156 21.431H25.4782V22.4766C25.4782 22.6224 25.4337 22.7364 25.3394 22.8314C25.245 22.9265 25.1319 22.9708 24.9936 22.9708C24.8678 22.9708 24.7673 22.9265 24.6729 22.8314C24.5849 22.7364 24.5347 22.6224 24.5347 22.4766V21.431H23.5029C23.3771 21.431 23.2703 21.3866 23.1822 21.2916C23.0879 21.2028 23.044 21.0824 23.044 20.9366C23.044 20.8162 23.0879 20.7085 23.1822 20.6134C23.2703 20.5247 23.3771 20.474 23.5029 20.474H24.5347V19.4284C24.5347 19.289 24.5786 19.1686 24.6729 19.0736C24.7673 18.9848 24.8741 18.9341 24.9936 18.9341C25.1319 18.9341 25.2513 18.9785 25.3394 19.0736C25.4337 19.1686 25.4782 19.2827 25.4782 19.4284V20.474H26.5156C26.6351 20.474 26.7425 20.5184 26.8368 20.6134C26.9311 20.7085 26.975 20.8162 26.975 20.9366C26.975 21.0824 26.9311 21.1965 26.8368 21.2916C26.7425 21.3866 26.6351 21.431 26.5156 21.431ZM24.9936 26C23.6539 26 22.4906 25.5184 21.522 24.5551C20.5471 23.5919 20.0377 22.4385 20 21.0887V20.9049C20.0252 19.986 20.2701 19.1432 20.7481 18.3891C21.2261 17.635 21.8366 17.0456 22.5914 16.6274C23.3461 16.2091 24.1443 16 24.9997 16C25.1381 16 25.2581 16.0444 25.3461 16.1395C25.4405 16.2345 25.4843 16.3423 25.4843 16.4627C25.4843 16.6084 25.4405 16.7225 25.3461 16.8175C25.2518 16.9126 25.1381 16.9569 24.9997 16.9569C23.9053 16.9569 22.9622 17.3498 22.1823 18.142C21.4024 18.9278 20.9998 19.8721 20.9809 20.981C20.9809 21.7605 21.1758 22.4576 21.5595 23.0849C21.9494 23.706 22.4404 24.194 23.0379 24.5425C23.6417 24.891 24.2894 25.0621 25.0064 25.0621C26.1449 25.0621 27.1004 24.6756 27.8804 23.8961C28.6603 23.1166 29.0566 22.1661 29.0566 21.0381C29.0566 20.8986 29.101 20.7782 29.1954 20.6831C29.2897 20.5944 29.4027 20.5437 29.5473 20.5437C29.692 20.5437 29.7991 20.5881 29.8808 20.6831C29.9563 20.7782 30 20.8923 30 21.0381C30 21.9823 29.7612 22.8314 29.2832 23.5982C28.8052 24.365 28.189 24.9607 27.4406 25.379C26.6795 25.7909 25.8615 26 24.9936 26Z"
                fill="currentColor"
              ></path>
            </svg>
          </i>
        </div>
        <div className="payment-info">
          <h3 className="title">Adicionar cartão</h3>
          <p className="description">
            Débito com CVV ou crédito Visa, Mastercard, American Express, Diners
            Club, ELO ou Hipercard.
          </p>
        </div>
        <div className="toggle">
          <input
            type="radio"
            name="payment"
            className="app_sm:after:!left-[-4px] app_sm:after:!top-[-4px]"
            checked={selectedMethod === "card"}
            onChange={() => handleSelect("card")}
          />
        </div>
      </div>
      {expandedMethod === "card" && (
        <div className="payment-details px-3">
          <h4 className="w-[100%] center mt-4 !justify-between pl-[50px] pr-[15px] mb-6 text-[rgb(16,0,79)] text-[0.875rem] leading-[1.25rem] tracking-[0.019rem]">
            Pagamento com cartão de crédito
            <span className="font-[600]">
              {totalPrice.toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </span>
          </h4>
          <CardForm ref={formRef} userData={data} totalPrice={totalPrice} />
        </div>
      )}
      <div
        className={`payment-card !rounded-[0px_0px_8px_8px] ${
          selectedMethod === "pix" ? "selected" : ""
        }`}
        onClick={() => handleSelect("pix")}
      >
        <div className="icon">
          <i>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              focusable="false"
              viewBox="0 0 32 32"
            >
              <path
                d="M5.27246 9.98433C6.32345 8.139 7.79972 6.63631 9.69638 5.47625C11.593 4.31619 13.6852 3.73371 15.9779 3.73371C17.7963 3.73371 19.5561 4.14487 21.2523 4.9623C22.7775 5.69651 24.0827 6.67547 25.1728 7.89916L22.9828 7.14047C22.7188 7.04747 22.4304 7.18942 22.3424 7.45373C22.2496 7.71805 22.3913 8.00684 22.6553 8.09495L25.598 9.11306C25.7007 9.14732 25.8034 9.16201 25.9011 9.16201C26.2873 9.16201 26.649 8.91727 26.781 8.53548L27.7978 5.58883C27.8907 5.32451 27.7489 5.03572 27.4849 4.94762C27.221 4.85462 26.9326 4.99656 26.8446 5.26088L26.1162 7.36563C24.9381 5.97552 23.5107 4.85951 21.8292 4.0274C19.9863 3.12187 18.0358 2.66666 15.9827 2.66666C14.2718 2.66666 12.6294 2.98482 11.0651 3.61624C9.49596 4.24767 8.08324 5.15809 6.81717 6.34752C5.55109 7.53205 4.5441 8.96622 3.7913 10.6402C3.04339 12.3142 2.66699 14.1008 2.66699 16C2.66699 16.3965 2.68166 16.7734 2.7061 17.1258C2.73054 17.4831 2.76965 17.8062 2.82342 18.0949C2.84786 18.2516 2.90652 18.374 2.9994 18.4523C3.09228 18.5306 3.20471 18.5697 3.33669 18.5697H3.3758V18.5306H3.4149C3.54689 18.5061 3.65932 18.4327 3.7522 18.3152C3.84507 18.1977 3.87929 18.0705 3.84996 17.9383C3.79619 17.5174 3.75709 17.1405 3.73264 16.8125C3.7082 16.4846 3.69354 16.2105 3.69354 16C3.69354 14.9476 3.82552 13.9099 4.08949 12.8918C4.35346 11.8786 4.74941 10.9094 5.27246 9.98433Z"
                fill="currentColor"
              ></path>
              <path
                d="M29.2985 14.9329C29.2741 14.5903 29.2301 14.2721 29.1812 13.9833C29.1567 13.8512 29.0834 13.7386 28.9661 13.6456C28.8488 13.5526 28.7217 13.5183 28.5897 13.5477C28.4577 13.5722 28.3453 13.6456 28.2524 13.7631C28.1595 13.8806 28.1253 14.0078 28.1546 14.14C28.2084 14.4581 28.2377 14.7665 28.2524 15.07C28.2671 15.3735 28.272 15.6818 28.272 16C28.272 17.581 27.9836 19.0984 27.4018 20.5521C26.8201 22.001 25.994 23.3079 24.9137 24.4679C23.8089 25.628 22.4744 26.558 20.9248 27.2579C19.3703 27.9579 17.723 28.3054 15.9876 28.3054C14.1154 28.3054 12.341 27.8992 10.6545 27.0768C9.12934 26.3377 7.82416 25.349 6.72918 24.1155H8.99736C9.27599 24.1155 9.50085 23.8903 9.50085 23.6113C9.50085 23.3323 9.27599 23.1072 8.99736 23.1072H5.88351C5.37023 23.1072 4.94984 23.5232 4.94984 24.0421V27.1552C4.94984 27.4342 5.1747 27.6593 5.45333 27.6593C5.73197 27.6593 5.95683 27.4342 5.95683 27.1552V24.791C7.15447 26.1273 8.55741 27.1943 10.1706 27.9873C11.989 28.883 13.9248 29.3333 15.9779 29.3333C17.1364 29.3333 18.2607 29.1963 19.3557 28.9173C20.4507 28.6383 21.4968 28.2124 22.4989 27.6299C24.5275 26.4944 26.1749 24.8987 27.4361 22.8429C28.7021 20.7871 29.3327 18.5061 29.3327 16C29.3376 15.6329 29.3229 15.2756 29.2985 14.9329Z"
                fill="currentColor"
              ></path>
              <path
                d="M5.27246 9.98433C6.32345 8.139 7.79972 6.63631 9.69638 5.47625C11.593 4.31619 13.6852 3.73371 15.9779 3.73371C17.7963 3.73371 19.5561 4.14487 21.2523 4.9623C22.7775 5.69651 24.0827 6.67547 25.1728 7.89916L22.9828 7.14047C22.7188 7.04747 22.4304 7.18942 22.3424 7.45373C22.2496 7.71805 22.3913 8.00684 22.6553 8.09495L25.598 9.11306C25.7007 9.14732 25.8034 9.16201 25.9011 9.16201C26.2873 9.16201 26.649 8.91727 26.781 8.53548L27.7978 5.58883C27.8907 5.32451 27.7489 5.03572 27.4849 4.94762C27.221 4.85462 26.9326 4.99656 26.8446 5.26088L26.1162 7.36563C24.9381 5.97552 23.5107 4.85951 21.8292 4.0274C19.9863 3.12187 18.0358 2.66666 15.9827 2.66666C14.2718 2.66666 12.6294 2.98482 11.0651 3.61624C9.49596 4.24767 8.08324 5.15809 6.81717 6.34752C5.55109 7.53205 4.5441 8.96622 3.7913 10.6402C3.04339 12.3142 2.66699 14.1008 2.66699 16C2.66699 16.3965 2.68166 16.7734 2.7061 17.1258C2.73054 17.4831 2.76965 17.8062 2.82342 18.0949C2.84786 18.2516 2.90652 18.374 2.9994 18.4523C3.09228 18.5306 3.20471 18.5697 3.33669 18.5697H3.3758V18.5306H3.4149C3.54689 18.5061 3.65932 18.4327 3.7522 18.3152C3.84507 18.1977 3.87929 18.0705 3.84996 17.9383C3.79619 17.5174 3.75709 17.1405 3.73264 16.8125C3.7082 16.4846 3.69354 16.2105 3.69354 16C3.69354 14.9476 3.82552 13.9099 4.08949 12.8918C4.35346 11.8786 4.74941 10.9094 5.27246 9.98433Z"
                stroke="currentColor"
                stroke-width="0.166667"
              ></path>
              <path
                d="M29.2985 14.9329C29.2741 14.5903 29.2301 14.2721 29.1812 13.9833C29.1567 13.8512 29.0834 13.7386 28.9661 13.6456C28.8488 13.5526 28.7217 13.5183 28.5897 13.5477C28.4577 13.5722 28.3453 13.6456 28.2524 13.7631C28.1595 13.8806 28.1253 14.0078 28.1546 14.14C28.2084 14.4581 28.2377 14.7665 28.2524 15.07C28.2671 15.3735 28.272 15.6818 28.272 16C28.272 17.581 27.9836 19.0984 27.4018 20.5521C26.8201 22.001 25.994 23.3079 24.9137 24.4679C23.8089 25.628 22.4744 26.558 20.9248 27.2579C19.3703 27.9579 17.723 28.3054 15.9876 28.3054C14.1154 28.3054 12.341 27.8992 10.6545 27.0768C9.12934 26.3377 7.82416 25.349 6.72918 24.1155H8.99736C9.27599 24.1155 9.50085 23.8903 9.50085 23.6113C9.50085 23.3323 9.27599 23.1072 8.99736 23.1072H5.88351C5.37023 23.1072 4.94984 23.5232 4.94984 24.0421V27.1552C4.94984 27.4342 5.1747 27.6593 5.45333 27.6593C5.73197 27.6593 5.95683 27.4342 5.95683 27.1552V24.791C7.15447 26.1273 8.55741 27.1943 10.1706 27.9873C11.989 28.883 13.9248 29.3333 15.9779 29.3333C17.1364 29.3333 18.2607 29.1963 19.3557 28.9173C20.4507 28.6383 21.4968 28.2124 22.4989 27.6299C24.5275 26.4944 26.1749 24.8987 27.4361 22.8429C28.7021 20.7871 29.3327 18.5061 29.3327 16C29.3376 15.6329 29.3229 15.2756 29.2985 14.9329Z"
                stroke="currentColor"
                stroke-width="0.166667"
              ></path>
              <path
                d="M16.4421 18.6662C16.5615 18.6686 16.6599 18.5678 16.6622 18.4425C16.6622 18.44 16.6622 18.4375 16.6622 18.4351V17.791C16.6716 17.7885 16.681 17.7861 16.6903 17.7836C16.9479 17.7369 17.1891 17.6435 17.3858 17.4862C17.5825 17.3288 17.7394 17.1026 17.7698 16.8273C17.8307 16.2791 17.5778 15.8833 17.2851 15.6645C16.9901 15.4481 16.6599 15.367 16.489 15.3326C16.3391 15.3031 16.0651 15.2343 15.8614 15.0843C15.6577 14.9343 15.5148 14.7377 15.557 14.3394C15.571 14.2017 15.6389 14.0936 15.7654 13.9928C15.8918 13.892 16.0768 13.8109 16.2782 13.774C16.6833 13.7002 17.1446 13.8084 17.3788 14.0567C17.4631 14.1477 17.5989 14.1477 17.6855 14.0592C17.7722 13.9707 17.7722 13.8256 17.6879 13.7371C17.4209 13.4519 17.0439 13.3241 16.6622 13.3044V12.68C16.6669 12.5546 16.5733 12.4489 16.4538 12.444C16.4421 12.444 16.4304 12.444 16.4187 12.4465C16.3087 12.4612 16.2244 12.562 16.229 12.68V13.3241C16.2197 13.3266 16.2103 13.3216 16.2009 13.3241C15.9434 13.3708 15.7022 13.4716 15.5055 13.6289C15.3088 13.7863 15.1519 14.0125 15.1214 14.2878C15.0605 14.836 15.3134 15.2318 15.6062 15.4506C15.9012 15.6669 16.2314 15.7407 16.4023 15.7776C16.5522 15.8071 16.8262 15.8808 17.0299 16.0332C17.2336 16.1832 17.3764 16.3725 17.3343 16.7708C17.3202 16.9084 17.2523 17.024 17.1259 17.1248C16.9994 17.2256 16.8144 17.3018 16.6131 17.3362C16.208 17.4099 15.7467 17.3091 15.5125 17.0609C15.4282 16.9723 15.29 16.9699 15.2057 17.0584C15.1214 17.1469 15.1191 17.2895 15.2034 17.378C15.4703 17.6632 15.8473 17.7935 16.229 17.8107V18.4351C16.229 18.5605 16.3227 18.6637 16.4421 18.6662Z"
                fill="currentColor"
                stroke="currentColor"
                stroke-width="0.333333"
              ></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M16.445 20.9782C19.4396 20.9782 21.8672 18.5506 21.8672 15.556C21.8672 12.5614 19.4396 10.1338 16.445 10.1338C13.4504 10.1338 11.0228 12.5614 11.0228 15.556C11.0228 18.5506 13.4504 20.9782 16.445 20.9782ZM16.445 22.2226C20.1269 22.2226 23.1117 19.2379 23.1117 15.556C23.1117 11.8741 20.1269 8.88931 16.445 8.88931C12.7631 8.88931 9.77832 11.8741 9.77832 15.556C9.77832 19.2379 12.7631 22.2226 16.445 22.2226Z"
                fill="currentColor"
              ></path>
            </svg>
          </i>
        </div>
        <div className="payment-info">
          <h3 className="title">
            PIX via SafetyPay <br className="hidden app_sm:block" />
            <span className="text-[#399515] text-[13px]">
              15% de desconto
            </span>{" "}
          </h3>
          <p className="description">
            Te enviaremos ao SafetyPay para continuar seu pagamento.
          </p>
        </div>
        <div className="toggle">
          <input
            type="radio"
            name="payment"
            className="app_sm:after:!left-[-4px] app_sm:after:!top-[-4px]"
            checked={selectedMethod === "pix"}
            onChange={() => handleSelect("pix")}
          />
        </div>
      </div>
      {expandedMethod === "pix" && (
        <div className="payment-details !rounded-[0px_0px_8px_8px]">
          <h4 className="w-[100%] center mt-4 !justify-between pl-[50px] pr-[15px] mb-6 text-[rgb(16,0,79)] text-[0.875rem] leading-[1.25rem] tracking-[0.019rem]">
            Valor a pagar{" "}
            <span className="font-[600]">
              {totalWithPix.toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </span>
          </h4>
        </div>
      )}
    </div>
  );
};

export default PaymentMethod;
